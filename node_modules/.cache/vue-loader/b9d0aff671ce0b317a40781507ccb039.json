{"remainingRequest":"C:\\Users\\marko\\IdeaProjects\\formula1_portal_web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\marko\\IdeaProjects\\formula1_portal_web\\src\\components\\UserManagement.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\marko\\IdeaProjects\\formula1_portal_web\\src\\components\\UserManagement.vue","mtime":1643551754808},{"path":"C:\\Users\\marko\\IdeaProjects\\formula1_portal_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\marko\\IdeaProjects\\formula1_portal_web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\marko\\IdeaProjects\\formula1_portal_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\marko\\IdeaProjects\\formula1_portal_web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnDQovL2ltcG9ydCB7IHJlcXVpcmVkIH0gZnJvbSAndnVlbGlkYXRlL2xpYi92YWxpZGF0b3JzJw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnVXNlck1hbmFnZW1lbnQnLA0KICBwcm9wczogew0KICAgIG1zZzogU3RyaW5nDQogIH0sDQogIG1vdW50ZWQgKCl7DQogICAgdGhpcy5nZXRVc2VycygpOw0KICB9LA0KICBkYXRhIDogZnVuY3Rpb24oKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHVzZXJzOiBbXSwNCiAgICAgIHVzZXJzRmllbGRzOiBbDQogICAgICAgIHtrZXk6ICdpZCcsIGxhYmVsOiAnSUQnLCBzb3J0YWJsZTogdHJ1ZX0sDQogICAgICAgIHtrZXk6ICd1c2VybmFtZScsIGxhYmVsOiAnVXNlcm5hbWUnLCBzb3J0YWJsZTogdHJ1ZX0sDQogICAgICAgIHtrZXk6ICdlbWFpbCcsIGxhYmVsOiAnRW1haWwnIH0NCiAgICAgIF0sDQogICAgICBzZWxlY3RlZFJvbGVzOiBbXSwNCiAgICAgIG9wdGlvbnM6IFsNCiAgICAgICAgeyB2YWx1ZTogMSwgdGV4dDogJ1JPTEVfVVNFUicgfSwNCiAgICAgICAgeyB2YWx1ZTogMiwgdGV4dDogJ1JPTEVfTU9ERVJBVE9SJyB9LA0KICAgICAgICB7IHZhbHVlOiAzLCB0ZXh0OiAnUk9MRV9BRE1JTicgfSwNCiAgICAgIF0NCiAgICB9IA0KICB9LA0KICBtZXRob2RzOiB7DQogICAgY2xlYXJSb2xlcygpew0KICAgICAgdGhpcy5zZWxlY3RlZFJvbGVzID0gW107DQogICAgfSwNCiAgICBmaWxsUm9sZXMocm9sZXMpew0KICAgICAgcm9sZXMuZm9yRWFjaChlbGVtZW50ID0+ew0KICAgICAgICBjb25zb2xlLmxvZyhlbGVtZW50KTsNCiAgICAgICAgY29uc29sZS5sb2coZWxlbWVudC5uYW1lKTsNCiAgICAgICAgdGhpcy5zZWxlY3RlZFJvbGVzLnB1c2goZWxlbWVudC5pZCkNCiAgICAgIH0pOw0KDQogICAgfSwNCiAgICBnZXRVc2VycygpIHsNCiAgICAgIGxldCBVUkwgPSAncG9ydGFsL2xpc3RVc2Vycyc7DQogICAgICBsZXQgcHJvbWlzZSA9IGF4aW9zLmdldChVUkwpDQogICAgICByZXR1cm4gcHJvbWlzZS50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgIGlmKHJlc3BvbnNlLnN0YXR1cyA9PSAnMjAwJyl7DQogICAgICAgICAgICB0aGlzLnVzZXJzID0gcmVzcG9uc2UuZGF0YS51c2Vycw0KICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgYWxlcnQoJ0FMRVJUJyk7DQogICAgICAgICAgfQ0KDQogICAgICAgIH0sDQogICAgICAgICkuY2F0Y2goZXJyID0+IHsNCiAgICAgICAgICBhbGVydCgnQUxFUlRSJyk7DQogICAgICAgIH0pDQogICAgfSwNCiAgICB1cGRhdGVVc2VyUm9sZXModXNlcklEKSB7DQogICAgICBsZXQgVVJMID0gJ3BvcnRhbC91cGRhdGVVc2VyUm9sZXMnOw0KICAgICAgbGV0IHByb21pc2UgPSBheGlvcy5wb3N0KFVSTCx7DQogICAgICAgIHVzZXJpZDogdXNlcklELA0KICAgICAgICByb2xlczogdGhpcy5zZWxlY3RlZFJvbGVzDQogICAgICB9KQ0KICAgICAgcmV0dXJuIHByb21pc2UudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgICBpZihyZXNwb25zZS5zdGF0dXMgPT0gJzIwMCcpew0KICAgICAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgnYnY6OnJlZnJlc2g6OnRhYmxlJywgJ3VzZXJUYWJsZScpOw0KICAgICAgICAgICAgdGhpcy5nZXRVc2VycygpOw0KICAgICAgICAgICAgdGhpcy5tYWtlVG9hc3QoIlVzZXIgUm9sZXMgRWRpdGVkIFN1Y2Nlc3NmdWxseSIsICJzdWNjZXNzIiwgcmVzcG9uc2UuZGF0YS5tZXNzYWdlLCAzMDAwMCk7DQogICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBhbGVydCgnQUxFUlQnKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCiAgICAgICAgKS5jYXRjaChlcnIgPT4gew0KICAgICAgICAgIGFsZXJ0KCdBTEVSVFInKTsNCiAgICAgICAgfSkNCiAgICB9LA0KICAgIGRlbGV0ZVVzZXIodXNlcm5hbWUpIHsNCiAgICAgIGxldCBVUkwgPSAncG9ydGFsL2RlbGV0ZVVzZXInOw0KICAgICAgbGV0IHByb21pc2UgPSBheGlvcy5kZWxldGUoVVJMLHsNCiAgICAgICAgZGF0YTogew0KICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZQ0KICAgICAgICB9DQogICAgICB9KQ0KDQogICAgICByZXR1cm4gcHJvbWlzZS50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICAgIGlmKHJlc3BvbnNlLnN0YXR1cyA9PSAnMjAwJyl7DQogICAgICAgICAgICB0aGlzLiRyb290LiRlbWl0KCdidjo6cmVmcmVzaDo6dGFibGUnLCAndXNlclRhYmxlJyk7DQogICAgICAgICAgICB0aGlzLmdldFVzZXJzKCk7DQogICAgICAgICAgICB0aGlzLm1ha2VUb2FzdCgiVXNlciBEZWxldGVkIFN1Y2Nlc3NmdWxseSIsICJzdWNjZXNzIiwgcmVzcG9uc2UuZGF0YS5tZXNzYWdlLCAzMDAwMCk7DQogICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBhbGVydCgnQUxFUlQnKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgfSwNCiAgICAgICAgKS5jYXRjaChlcnIgPT4gew0KICAgICAgICAgIGFsZXJ0KCdBTEVSVFInKTsNCiAgICAgICAgfSkNCiAgICB9LA0KICAgIG1ha2VUb2FzdCh0aXRsZSwgdmFyaWFudCwgY29udGVudCwgZGVsYXkpIHsNCiAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoY29udGVudCwgew0KICAgICAgICAgIHRpdGxlOiB0aXRsZSwNCiAgICAgICAgICB0b2FzdGVyOiAnYi10b2FzdGVyLXRvcC1jZW50ZXInLA0KICAgICAgICAgIHZhcmlhbnQ6IHZhcmlhbnQsDQogICAgICAgICAgc29saWQ6IHRydWUsDQogICAgICAgICAgImF1dG8taGlkZS1kZWxheSI6IGRlbGF5DQogICAgICB9KQ0KICAgIH0sDQoNCiAgfQ0KfQ0K"},{"version":3,"sources":["UserManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"UserManagement.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"hello\">\r\n    <b-button class=\"userButtons\" variant=\"outline-success\">Add User</b-button>\r\n\r\n    <div class=\"userTable\">\r\n      <b-table\r\n        no-border-collapse\r\n        small\r\n        head-variant=\"light\"\r\n        responsive\r\n        hover\r\n        primary-key=\"id\"\r\n        :items=\"users\"\r\n        :fields=\"usersFields\"\r\n        ref=\"userTable\"\r\n        id=\"userTable\"\r\n        @row-clicked=\"item=>$set(item, '_showDetails', !item._showDetails)\"\r\n        >\r\n\r\n        <template slot=\"row-details\" slot-scope=\"row\">\r\n          <b-card class=\"userCards\">\r\n            <b-row class=\"mb-2\">\r\n              <b-col sm=\"3\" class=\"text-sm-right\"><b>Roles:</b></b-col>\r\n              <b-col>{{ row.item.roles }}</b-col>\r\n            </b-row>\r\n            <b-button class=\"button\" variant=\"outline-danger\" @click=\"deleteUser(row.item.username)\">Delete User</b-button>\r\n            <b-button v-b-modal.editRoles class=\"button\" variant=\"outline-info\" @click=\"clearRoles();fillRoles(row.item.roles)\">Edit Roles</b-button>\r\n            <b-button class=\"button\" variant=\"outline-info\">Reset Password</b-button>\r\n\r\n            <b-modal id=\"editRoles\" @ok=\"updateUserRoles(row.item.id)\">\r\n              \r\n              <b-form-select v-model=\"selectedRoles\" :options=\"options\" multiple :select-size=\"4\"></b-form-select>\r\n\r\n            </b-modal>\r\n          </b-card>\r\n\r\n        </template>\r\n      </b-table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\n//import { required } from 'vuelidate/lib/validators'\r\nexport default {\r\n  name: 'UserManagement',\r\n  props: {\r\n    msg: String\r\n  },\r\n  mounted (){\r\n    this.getUsers();\r\n  },\r\n  data : function() {\r\n    return {\r\n      users: [],\r\n      usersFields: [\r\n        {key: 'id', label: 'ID', sortable: true},\r\n        {key: 'username', label: 'Username', sortable: true},\r\n        {key: 'email', label: 'Email' }\r\n      ],\r\n      selectedRoles: [],\r\n      options: [\r\n        { value: 1, text: 'ROLE_USER' },\r\n        { value: 2, text: 'ROLE_MODERATOR' },\r\n        { value: 3, text: 'ROLE_ADMIN' },\r\n      ]\r\n    } \r\n  },\r\n  methods: {\r\n    clearRoles(){\r\n      this.selectedRoles = [];\r\n    },\r\n    fillRoles(roles){\r\n      roles.forEach(element =>{\r\n        console.log(element);\r\n        console.log(element.name);\r\n        this.selectedRoles.push(element.id)\r\n      });\r\n\r\n    },\r\n    getUsers() {\r\n      let URL = 'portal/listUsers';\r\n      let promise = axios.get(URL)\r\n      return promise.then((response) => {\r\n          if(response.status == '200'){\r\n            this.users = response.data.users\r\n          }else{\r\n            alert('ALERT');\r\n          }\r\n\r\n        },\r\n        ).catch(err => {\r\n          alert('ALERTR');\r\n        })\r\n    },\r\n    updateUserRoles(userID) {\r\n      let URL = 'portal/updateUserRoles';\r\n      let promise = axios.post(URL,{\r\n        userid: userID,\r\n        roles: this.selectedRoles\r\n      })\r\n      return promise.then((response) => {\r\n          if(response.status == '200'){\r\n            this.$root.$emit('bv::refresh::table', 'userTable');\r\n            this.getUsers();\r\n            this.makeToast(\"User Roles Edited Successfully\", \"success\", response.data.message, 30000);\r\n          }else{\r\n            alert('ALERT');\r\n          }\r\n\r\n        },\r\n        ).catch(err => {\r\n          alert('ALERTR');\r\n        })\r\n    },\r\n    deleteUser(username) {\r\n      let URL = 'portal/deleteUser';\r\n      let promise = axios.delete(URL,{\r\n        data: {\r\n          username: username\r\n        }\r\n      })\r\n\r\n      return promise.then((response) => {\r\n          if(response.status == '200'){\r\n            this.$root.$emit('bv::refresh::table', 'userTable');\r\n            this.getUsers();\r\n            this.makeToast(\"User Deleted Successfully\", \"success\", response.data.message, 30000);\r\n          }else{\r\n            alert('ALERT');\r\n          }\r\n\r\n        },\r\n        ).catch(err => {\r\n          alert('ALERTR');\r\n        })\r\n    },\r\n    makeToast(title, variant, content, delay) {\r\n      this.$bvToast.toast(content, {\r\n          title: title,\r\n          toaster: 'b-toaster-top-center',\r\n          variant: variant,\r\n          solid: true,\r\n          \"auto-hide-delay\": delay\r\n      })\r\n    },\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style >\r\n  .userButtons{\r\n    margin-top: 1%;\r\n    margin-bottom: 1%;\r\n    width: 97%;\r\n  }\r\n  .button{\r\n    width: 20%;\r\n    float: right;\r\n  }\r\n  .userTable{\r\n    margin: 0 auto;\r\n    width: 97%;\r\n  }\r\n  .userCards {\r\n    border: none;\r\n  }\r\n  .table-hover tbody tr:hover td, .table-hover tbody tr:hover th {\r\n    background-color: #d7faf9;\r\n  }\r\n</style>\r\n"]}]}